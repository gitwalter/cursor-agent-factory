{
  "metadata": {
    "patternId": "ddic-grounding",
    "patternName": "DDIC Grounding Skill",
    "category": "sap-grounding",
    "stackAgnostic": false,
    "description": "Verify SAP Data Dictionary objects (tables, structures, data elements, domains, search helps, lock objects) before implementation",
    "composable": true,
    "version": "1.0.0"
  },
  "frontmatter": {
    "name": "ddic-grounding",
    "description": "Verify DDIC objects including tables, structures, data elements, domains, and related artifacts",
    "type": "skill",
    "knowledge": ["ddic-catalog.json", "released-apis.json"]
  },
  "sections": {
    "title": "DDIC Grounding Skill",
    "introduction": "Ensures all SAP Data Dictionary objects are verified against authoritative sources before implementation. Covers tables, structures, data elements, domains, table types, search helps, lock objects, and foreign key relationships.",
    "artifactTypes": [
      {
        "type": "table",
        "description": "Transparent, pool, and cluster tables",
        "verifications": ["existence", "fields", "types", "lengths", "keys", "delivery_class", "table_category"]
      },
      {
        "type": "structure",
        "description": "Flat and deep structures, includes, appends",
        "verifications": ["existence", "components", "types", "includes", "append_structures"]
      },
      {
        "type": "data_element",
        "description": "Field properties and labels",
        "verifications": ["existence", "domain", "labels", "documentation", "search_help"]
      },
      {
        "type": "domain",
        "description": "Technical properties and value ranges",
        "verifications": ["existence", "data_type", "length", "decimals", "fixed_values", "value_table", "conversion_exit"]
      },
      {
        "type": "table_type",
        "description": "Internal table type definitions",
        "verifications": ["existence", "line_type", "key_definition", "table_kind"]
      },
      {
        "type": "search_help",
        "description": "Elementary and collective search helps",
        "verifications": ["existence", "type", "selection_method", "parameters", "export_fields"]
      },
      {
        "type": "lock_object",
        "description": "Enqueue/dequeue mechanisms",
        "verifications": ["existence", "lock_parameters", "lock_mode", "primary_table", "secondary_tables"]
      }
    ],
    "whenToUse": [
      "When referencing any SAP table or structure",
      "Before implementing data access logic using SELECT statements",
      "When designing data models based on SAP standard tables",
      "Before assuming any field, data element, or domain exists",
      "When mapping fields between structures",
      "When implementing search help or lock object functionality"
    ],
    "process": [
      {
        "step": 1,
        "name": "Check Knowledge Cache",
        "description": "Look for cached definitions in knowledge files",
        "actions": [
          "Query knowledge/ddic-catalog.json for table/structure definitions",
          "Check released-apis.json for release contract status"
        ]
      },
      {
        "step": 2,
        "name": "Search SAP Documentation",
        "description": "If not cached, search SAP official documentation",
        "mcpTools": ["SAP_Documentation_MCP_Server-search", "SAP_Documentation_MCP_Server-sap_help_search"],
        "queryPatterns": {
          "table": "{TABLE_NAME} table structure fields DDIC ABAP",
          "data_element": "{DTEL_NAME} data element domain labels",
          "domain": "{DOMAIN_NAME} domain fixed values conversion exit",
          "search_help": "{SHLP_NAME} search help parameters"
        }
      },
      {
        "step": 3,
        "name": "Verify Object Existence",
        "description": "Confirm the DDIC object exists in the SAP system",
        "verifications": [
          "TADIR entry for object type and name",
          "Package assignment",
          "Object status (active, inactive)"
        ]
      },
      {
        "step": 4,
        "name": "Verify Field Details",
        "description": "For tables/structures, verify specific field properties",
        "verifications": [
          "Field name exists in structure",
          "Field data type matches expected",
          "Field length and decimals",
          "Key field status",
          "Foreign key relationships"
        ]
      },
      {
        "step": 5,
        "name": "Check Release Status",
        "description": "Verify release contract for ABAP Cloud compatibility",
        "verifications": [
          "C0 (Extend) - Can be extended",
          "C1 (System-Internal) - Use in same system",
          "C2 (Remote API) - Remote access allowed",
          "Deprecation status and successor"
        ]
      },
      {
        "step": 6,
        "name": "Document Verification",
        "description": "Record all verification results with sources",
        "outputs": [
          "Verification table with object, property, status, source",
          "Confidence level (HIGH/MEDIUM/LOW)",
          "Any warnings or issues found"
        ]
      },
      {
        "step": 7,
        "name": "Handle Unverified",
        "description": "Escalate if verification fails",
        "actions": [
          "STOP if critical object cannot be verified",
          "ASK USER for confirmation before proceeding",
          "Suggest alternatives if object deprecated"
        ]
      }
    ],
    "outputFormat": "### DDIC Verification Results\n\n**Object Type:** {TYPE}\n**Object Name:** {NAME}\n**Confidence:** {HIGH|MEDIUM|LOW}\n**Release Status:** {C0|C1|C2|Not Released}\n\n| Property | Expected | Verified | Source |\n|----------|----------|----------|--------|\n| {PROPERTY} | {EXPECTED} | {YES/NO} | {SOURCE} |\n\n**Issues Found:**\n- {ISSUE_LIST}\n\n**Recommendation:** {PROCEED|STOP|ASK_USER}",
    "importantRules": [
      "NEVER assume a table or field exists without verification",
      "ALWAYS check release contracts for ABAP Cloud projects",
      "Foreign key relationships must be verified, not assumed",
      "Data element labels and domains affect UI behavior - verify them",
      "Conversion exits in domains can transform data - document when found",
      "If verification fails, STOP and ASK user - do not hallucinate"
    ],
    "fallbackProcedures": [
      {
        "condition": "Table/structure not found in documentation",
        "action": "ASK USER: 'I cannot verify {OBJECT}. Is this a custom object in your system? Please confirm its structure.'"
      },
      {
        "condition": "Field not found in table",
        "action": "Report finding, suggest checking for append structures or custom fields"
      },
      {
        "condition": "Object is deprecated",
        "action": "Report deprecation status and suggest successor object if documented"
      },
      {
        "condition": "Release contract missing (ABAP Cloud)",
        "action": "WARN: Object may not be available in ABAP Cloud/BTP environment"
      }
    ],
    "confidenceLevels": {
      "HIGH": "Found in SAP official documentation with exact match",
      "MEDIUM": "Found in community resources or partial match",
      "LOW": "Inferred from patterns or limited sources"
    }
  },
  "variables": [
    {"name": "{OBJECT_TYPE}", "description": "Type: TABLE, STRUCTURE, DTEL, DOMAIN, TTYP, SHLP, ENQU", "required": true},
    {"name": "{OBJECT_NAME}", "description": "Technical name of the DDIC object", "required": true},
    {"name": "{FIELD_NAME}", "description": "Specific field to verify (optional)", "required": false},
    {"name": "{TARGET_RELEASE}", "description": "Target SAP release for compatibility check", "required": false}
  ]
}
