{
  "metadata": {
    "patternId": "fiori-grounding",
    "patternName": "Fiori Grounding Skill",
    "category": "sap-grounding",
    "stackAgnostic": false,
    "description": "Verify SAP Fiori apps, semantic objects, UI5 components, and Fiori Elements annotations",
    "composable": true,
    "version": "1.0.0"
  },
  "frontmatter": {
    "name": "fiori-grounding",
    "description": "Verify SAP Fiori and UI5 artifacts including app registrations, semantic objects, and annotations",
    "type": "skill",
    "knowledge": ["fiori-catalog.json"]
  },
  "sections": {
    "title": "Fiori Grounding Skill",
    "introduction": "Ensures all SAP Fiori and UI5 artifacts are verified before implementation. Covers Fiori app registrations, semantic objects and actions, UI5 components, Fiori Elements annotations, and target mappings.",
    "artifactTypes": [
      {
        "type": "fiori_app",
        "description": "Registered Fiori application",
        "verifications": ["app_id", "catalog", "role_assignment", "tile_configuration"]
      },
      {
        "type": "semantic_object",
        "description": "Intent navigation semantic objects",
        "verifications": ["object_name", "actions", "parameters", "target_mappings"]
      },
      {
        "type": "ui5_component",
        "description": "UI5 application component",
        "verifications": ["component_id", "manifest_properties", "dependencies"]
      },
      {
        "type": "fiori_elements_annotation",
        "description": "Annotations for Fiori Elements",
        "verifications": ["annotation_type", "valid_values", "element_applicability"]
      },
      {
        "type": "target_mapping",
        "description": "Intent to application mapping",
        "verifications": ["semantic_object", "action", "target_app", "parameters"]
      }
    ],
    "fioriElementsFloorplans": {
      "list_report": "List Report with optional Object Page",
      "overview_page": "Overview Page with cards",
      "analytical_list_page": "Analytical List Page",
      "worklist": "Worklist application",
      "object_page": "Object Page for single object display",
      "form_entry": "Form entry/wizard scenarios"
    },
    "annotationNamespaces": {
      "ui": "@UI - User Interface annotations",
      "common": "@Common - Common vocabulary annotations",
      "communication": "@Communication - Contact/address annotations",
      "analytics": "@Analytics - Analytical annotations",
      "aggregation": "@Aggregation - Aggregation behavior",
      "capabilities": "@Capabilities - OData capabilities"
    },
    "whenToUse": [
      "When developing or extending Fiori applications",
      "Before defining semantic objects or actions",
      "When implementing intent-based navigation",
      "When adding Fiori Elements annotations",
      "Before assuming Fiori app configurations exist"
    ],
    "process": [
      {
        "step": 1,
        "name": "Check Knowledge Cache",
        "description": "Look for cached Fiori definitions",
        "actions": [
          "Query knowledge/fiori-catalog.json for app registrations",
          "Check for semantic object definitions"
        ]
      },
      {
        "step": 2,
        "name": "Search SAP Documentation",
        "description": "Search for Fiori artifact documentation",
        "mcpTools": ["SAP_Documentation_MCP_Server-search", "SAP_Documentation_MCP_Server-sap_help_search"],
        "queryPatterns": {
          "app": "{APP_ID} Fiori app SAP",
          "semantic_object": "{SEMANTIC_OBJECT} semantic object action",
          "annotation": "{ANNOTATION} Fiori Elements UI annotation"
        }
      },
      {
        "step": 3,
        "name": "Search SAP Fiori Apps Library",
        "description": "Check SAP Fiori Apps Reference Library",
        "actions": [
          "Search for app in SAP Fiori Apps Reference Library",
          "Check implementation information",
          "Verify configuration requirements"
        ]
      },
      {
        "step": 4,
        "name": "Verify App Registration",
        "description": "Confirm Fiori app is registered",
        "verifications": [
          "App ID exists",
          "Technical catalog assignment",
          "Role-based catalog assignment",
          "Tile/target configuration"
        ]
      },
      {
        "step": 5,
        "name": "Verify Semantic Object",
        "description": "Check semantic object definition",
        "verifications": [
          "Semantic object exists",
          "Actions defined for object",
          "Required parameters",
          "Target mappings available"
        ]
      },
      {
        "step": 6,
        "name": "Verify Target Mapping",
        "description": "Check intent to app mapping",
        "verifications": [
          "Target mapping exists for intent",
          "Target application configured",
          "Parameter mappings correct"
        ]
      },
      {
        "step": 7,
        "name": "Verify UI5 Component",
        "description": "Check component configuration",
        "verifications": [
          "Component ID valid",
          "Manifest.json structure",
          "Data sources configured",
          "Dependencies available"
        ]
      },
      {
        "step": 8,
        "name": "Verify Annotations",
        "description": "Check Fiori Elements annotations",
        "verifications": [
          "Annotation is valid for element type",
          "Annotation values in allowed set",
          "Annotation combinations valid",
          "OData version compatibility"
        ]
      },
      {
        "step": 9,
        "name": "Document and Escalate",
        "description": "Record results and handle failures",
        "actions": [
          "Document all verifications",
          "STOP and ASK if app unverified",
          "Suggest configuration for missing elements"
        ]
      }
    ],
    "commonAnnotations": {
      "lineItem": "@UI.lineItem - Columns in list/table",
      "selectionField": "@UI.selectionField - Filter bar fields",
      "fieldGroup": "@UI.fieldGroup - Grouped fields on object page",
      "facet": "@UI.facet - Object page sections",
      "identification": "@UI.identification - Header info and actions",
      "chart": "@UI.chart - Analytical chart configuration",
      "presentationVariant": "@UI.presentationVariant - Default sorting/grouping",
      "selectionVariant": "@UI.selectionVariant - Default filters"
    },
    "outputFormat": "### Fiori Verification Results\n\n**Artifact:** {ARTIFACT_NAME}\n**Type:** {APP|SEMANTIC_OBJECT|COMPONENT|ANNOTATION}\n**Verified:** {YES|NO|PARTIAL}\n\n#### App Registration (if Fiori App)\n| Property | Value | Verified |\n|----------|-------|----------|\n| App ID | {APP_ID} | {YES/NO} |\n| Technical Catalog | {CATALOG} | {YES/NO} |\n| Semantic Object | {SO} | {YES/NO} |\n| Action | {ACTION} | {YES/NO} |\n\n#### Semantic Object (if navigation)\n| Property | Value | Verified |\n|----------|-------|----------|\n| Semantic Object | {SO} | {YES/NO} |\n| Action | {ACTION} | {YES/NO} |\n| Required Params | {PARAMS} | {YES/NO} |\n| Target App | {TARGET} | {YES/NO} |\n\n#### Annotations Verified (if Fiori Elements)\n| Annotation | Element | Valid | Issues |\n|------------|---------|-------|--------|\n| {ANNOTATION} | {ELEMENT} | {YES/NO} | {ISSUES} |\n\n**Issues Found:**\n- {ISSUE_LIST}\n\n**Recommendation:** {PROCEED|STOP|ASK_USER}",
    "importantRules": [
      "NEVER assume semantic objects or actions exist without verification",
      "Annotation values must be valid for the annotation type",
      "Target mappings must exist for intent-based navigation to work",
      "Fiori Elements annotations are version-specific (V2 vs V4)",
      "Catalog assignments affect app visibility - verify role requirements",
      "If app/semantic object unverified, STOP and ASK user"
    ],
    "fallbackProcedures": [
      {
        "condition": "App not found in Fiori library",
        "action": "ASK USER: 'Cannot verify Fiori app {APP_ID}. Is this a custom app? Please provide its configuration.'"
      },
      {
        "condition": "Semantic object not found",
        "action": "WARN: Semantic object {SO} not found. Intent navigation may not work."
      },
      {
        "condition": "Annotation not valid for element",
        "action": "WARN: Annotation {ANNOTATION} is not valid for element type. Check Fiori Elements documentation."
      },
      {
        "condition": "Target mapping missing",
        "action": "WARN: No target mapping found for {SO}-{ACTION}. Navigation will fail."
      }
    ]
  },
  "variables": [
    {"name": "{APP_ID}", "description": "Fiori app ID", "required": false},
    {"name": "{SEMANTIC_OBJECT}", "description": "Semantic object name", "required": false},
    {"name": "{ACTION}", "description": "Semantic action", "required": false},
    {"name": "{ANNOTATION}", "description": "Annotation to verify", "required": false}
  ]
}
