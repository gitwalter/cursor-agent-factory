{
  "metadata": {
    "patternId": "smart-contract-testing",
    "patternName": "Smart Contract Testing Skill",
    "category": "testing",
    "stackAgnostic": false,
    "stacks": ["solidity", "ethereum"],
    "description": "Comprehensive testing patterns for smart contracts"
  },
  "frontmatter": {
    "name": "smart-contract-testing",
    "description": "Test smart contracts for functionality, security, and edge cases",
    "type": "skill",
    "knowledge": ["solidity-patterns.json", "ethereum-security.json"]
  },
  "sections": {
    "title": "Smart Contract Testing Skill",
    "purpose": "Ensure smart contracts behave correctly through comprehensive unit, integration, and fuzz testing.",
    "workflow": [
      {
        "step": 1,
        "name": "Unit Tests",
        "description": "Test individual functions in isolation",
        "patterns": [
          "Test all public and external functions",
          "Test require/revert conditions",
          "Test modifier behavior",
          "Test event emissions"
        ]
      },
      {
        "step": 2,
        "name": "Integration Tests",
        "description": "Test contract interactions",
        "patterns": [
          "Test multi-contract interactions",
          "Test upgrade paths (if upgradeable)",
          "Test with realistic deployment scenarios",
          "Test access control across contracts"
        ]
      },
      {
        "step": 3,
        "name": "Fuzz Testing",
        "description": "Property-based testing with random inputs",
        "patterns": [
          "Invariant testing for state properties",
          "Stateful fuzz testing for sequences",
          "Boundary value testing",
          "Type confusion testing"
        ]
      },
      {
        "step": 4,
        "name": "Fork Testing",
        "description": "Test against mainnet state",
        "patterns": [
          "Fork mainnet for realistic conditions",
          "Test oracle integrations",
          "Test with real token balances",
          "Simulate historical transactions"
        ]
      }
    ],
    "testingFrameworks": [
      {"name": "Foundry", "command": "forge test", "preferred": true},
      {"name": "Hardhat", "command": "npx hardhat test"},
      {"name": "Brownie", "command": "brownie test"}
    ],
    "coverageRequirements": {
      "minimum": "90% line coverage",
      "critical_functions": "100% branch coverage",
      "security_paths": "All revert conditions tested"
    },
    "outputFormat": "Test results with coverage report, gas usage per test, and any failing assertions with detailed error messages."
  },
  "variables": [
    {"name": "{TEST_FRAMEWORK}", "description": "Testing framework (foundry/hardhat)", "required": false},
    {"name": "{FORK_URL}", "description": "RPC URL for fork testing", "required": false}
  ]
}
