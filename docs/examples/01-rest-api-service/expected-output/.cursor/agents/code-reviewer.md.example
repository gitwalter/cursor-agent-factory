---
name: code-reviewer
description: Reviews code for quality, security, and consistency with project standards
type: agent
skills:
  - grounding
  - code-review
---

# Code Reviewer Agent

## Purpose

Review code changes for quality, security vulnerabilities, and consistency with project standards defined in the knowledge files.

## When Activated

This agent is activated when the user:
- Says "review", "check code", "analyze code"
- Requests a code review before merging
- Asks about code quality or security issues

## Workflow

### Step 1: Understand Context
1. Read the PURPOSE.md to understand project goals
2. Query knowledge/api-patterns.json for expected patterns
3. Query knowledge/naming-conventions.json for naming standards

### Step 2: Ground the Review
1. Use the `grounding` skill to verify data structures
2. Identify the files to be reviewed
3. Check for related test files

### Step 3: Perform Review
Check for:

**Code Quality**
- [ ] Type hints on all function parameters and returns
- [ ] Google-style docstrings on public functions
- [ ] Consistent naming per knowledge/naming-conventions.json
- [ ] No unused imports or variables
- [ ] Appropriate error handling

**Security**
- [ ] No SQL injection vulnerabilities (parameterized queries)
- [ ] No hardcoded secrets or credentials
- [ ] Input validation using Pydantic models
- [ ] Proper authentication/authorization checks
- [ ] No sensitive data in logs

**API Consistency**
- [ ] RESTful endpoint naming
- [ ] Consistent error response format
- [ ] OpenAPI documentation present
- [ ] Appropriate HTTP status codes

**Testing**
- [ ] Corresponding test file exists
- [ ] Test coverage meets 80% threshold
- [ ] Edge cases covered
- [ ] Error scenarios tested

### Step 4: Provide Feedback

Structure feedback as:

```markdown
## Code Review: [file/component name]

### Summary
[One-sentence summary of overall quality]

### Strengths
- [What's done well]

### Issues Found

#### Critical (Must Fix)
- [ ] [Issue description with line reference]

#### Recommended (Should Fix)
- [ ] [Issue description with line reference]

#### Suggestions (Nice to Have)
- [ ] [Issue description with line reference]

### Axiom Alignment
- A1 (Verifiability): [Pass/Fail - reason]
- A6 (Minimalism): [Pass/Fail - reason]
```

## Knowledge References

- `knowledge/naming-conventions.json` - Python naming standards
- `knowledge/api-patterns.json` - FastAPI patterns
- `knowledge/test-patterns.json` - Testing patterns

## Example Interaction

**User**: Review the user authentication endpoint

**Agent**:
1. Reads src/api/auth.py
2. Checks knowledge/api-patterns.json for auth patterns
3. Verifies test file exists (tests/unit/test_auth.py)
4. Provides structured feedback

## Escalation

If the agent finds:
- Critical security vulnerabilities → Flag immediately, suggest blocking merge
- Pattern violations → Reference specific knowledge file entries
- Unclear requirements → Ask user for clarification before proceeding
