# Travel Booking RAP - Cursor Agent Rules
# Generated by Cursor Agent Factory
# 5-Layer Architecture with Comprehensive Enforcement

# ═══════════════════════════════════════════════════════════════════════════════
# LAYER 0: INTEGRITY & LOGIC (Axioms)
# ═══════════════════════════════════════════════════════════════════════════════

## Core Axioms (Immutable)

### A1: Verifiability
All code must be grounded in SAP documentation:
- CDS syntax verified against SAP Help
- Behavior patterns match RAP guidelines
- Annotations sourced from official docs

### A2: User Primacy
Business user needs take precedence:
- Fiori UX guidelines followed
- Accessibility standards met
- Performance optimized for users

### A3: Transparency
All decisions explainable:
- Transport dependencies documented
- Architecture decisions recorded
- Change reasons captured

### A4: Non-Harm
No system-breaking changes:
- ATC checks mandatory
- Transport validation required
- Backup before destructive operations

### A5: Consistency
SAP naming conventions enforced:
- Z/Y namespace for custom objects
- Consistent field naming
- Standard annotation patterns

## Optional Axioms (Selected)

### A6: Minimalism
Simplest SAP implementation:
- No unnecessary custom code
- Use standard Fiori Elements where possible
- Avoid over-customization

### A7: Reversibility
Changes must be reversible:
- Transport system enables rollback
- No destructive data changes without backup
- Feature flags for new functionality

# ═══════════════════════════════════════════════════════════════════════════════
# LAYER 1: PURPOSE
# ═══════════════════════════════════════════════════════════════════════════════

## Mission
To accelerate SAP RAP development by grounding all code in official documentation
and enforcing SAP best practices.

## Primary Stakeholders
SAP ABAP developers building Fiori applications on S/4HANA or BTP (team of 4-8).

## Success Criteria
100% compliance with SAP RAP guidelines as verified against official documentation.

# ═══════════════════════════════════════════════════════════════════════════════
# LAYER 2: PRINCIPLES
# ═══════════════════════════════════════════════════════════════════════════════

## Quality Standards

### Code Quality
- ABAP Clean Code principles
- ATC checks with no errors
- ABAP Unit test coverage >= 80%
- CDS annotations properly documented

### SAP Compliance
- RAP strict mode enabled
- Fiori Elements patterns used
- OData V4 compliance
- Draft handling where appropriate

## Ethical Boundaries

### Data Protection
- Personal data handling per GDPR
- Authorization checks on all entities
- Audit logging for sensitive operations

# ═══════════════════════════════════════════════════════════════════════════════
# LAYER 3: METHODOLOGY & ENFORCEMENT
# ═══════════════════════════════════════════════════════════════════════════════

## Development Methodology: Enterprise Integration

### Change Management
- Transport-based deployment
- CAB (Change Advisory Board) approval
- Release windows for production

### Team Coordination
- 4-8 developers
- Cross-functional with basis team
- Regular sync with business

## Enforcement Patterns (Active)

### E1: Quality Enforcement
- ABAP Unit test coverage gate: 80%
- ATC check: no errors, warnings reviewed
- Code review: 1 approver minimum
- Documentation: CDS annotations complete

### E2: Safety Enforcement
- Destructive confirmation: required for DELETE
- Transport validation: syntax check mandatory
- Backup reminder: before data migration
- Environment protection: no direct prod changes

### E3: Integrity Enforcement
- Axiom compliance check: before transport
- Purpose alignment: feature justification
- Grounding verification: SAP docs cited

## Practice Patterns (Active)

### Daily Practices
- Morning intention: align with sprint goal
- Transport review: check dependencies
- Documentation sync: update CDS comments

### Craft Practices
- Code review: ABAP Clean Code focus
- Pair programming: complex logic
- Refactoring: continuous improvement

# ═══════════════════════════════════════════════════════════════════════════════
# LAYER 4: TECHNICAL
# ═══════════════════════════════════════════════════════════════════════════════

## Technology Stack

### Backend
- ABAP Cloud / RAP
- CDS Views (data modeling)
- Behavior Definitions
- ABAP Classes (implementation)

### Frontend
- SAP Fiori Elements
- OData V4
- No custom UI code (standard elements)

### Environment
- SAP BTP ABAP Environment
- or S/4HANA Cloud/On-Premise

### Testing
- ABAP Unit
- ATC (ABAP Test Cockpit)
- Fiori Test Recorder

## SAP Naming Conventions

### CDS Views
- Interface views: ZI_EntityName
- Consumption views: ZC_EntityName
- Extension views: ZE_EntityName

### Behavior
- Behavior class: ZBP_I_EntityName
- Behavior definition: ZI_EntityName.bdef

### Tables
- Custom tables: Z + domain abbreviation + name

## Project Structure
```
src/
├── cds/
│   ├── zi_travel.cds           # Interface view
│   ├── zc_travel.cds           # Consumption view
│   └── zi_travel.bdef          # Behavior definition
├── classes/
│   ├── zbp_i_travel.clas.abap  # Behavior implementation
│   └── zcl_travel_helper.clas.abap
├── tables/
│   └── ztravel.tabl.xml
└── tests/
    └── ztcl_travel_tests.clas.abap
```

# ═══════════════════════════════════════════════════════════════════════════════
# AGENT REGISTRY
# ═══════════════════════════════════════════════════════════════════════════════

## Available Agents

### code-reviewer
- Focus: RAP patterns, ABAP Clean Code, CDS annotations
- Skills: grounding

### test-generator
- Focus: ABAP Unit tests for behavior
- Skills: tdd

## Available Skills

### grounding
- Purpose: Verify code against SAP documentation
- MCP: SAP Documentation Server
- Process: Query → Verify → Cite sources

### bugfix-workflow
- Purpose: Solution Manager incident resolution
- Trigger: Incident number

### feature-workflow
- Purpose: Change request implementation
- Trigger: CR number

# ═══════════════════════════════════════════════════════════════════════════════
# MCP SERVER INTEGRATION
# ═══════════════════════════════════════════════════════════════════════════════

## SAP Documentation MCP
- Tools: search, sap_help_search, sap_help_get, sap_community_search
- Purpose: Ground all SAP code in official documentation
- Usage: Query before implementing, verify after coding

### Grounding Process
1. Before implementation: Query SAP Help for syntax/patterns
2. During implementation: Reference documentation
3. After implementation: Verify compliance
4. In review: Cite sources for validation

# ═══════════════════════════════════════════════════════════════════════════════
# BEHAVIOR RULES
# ═══════════════════════════════════════════════════════════════════════════════

## RAP Rules
1. Use strict mode ( 2 ) for all behaviors
2. Enable draft handling for transactional apps
3. Use managed implementation where possible
4. Define authorization master

## CDS Rules
1. Always add @EndUserText annotations
2. Use semantic annotations for currencies/quantities
3. Define associations for navigation
4. Add metadata extensions for UI

## Transport Rules
1. Never transport directly to production
2. Include all dependent objects
3. Document transport request
4. Get CAB approval for production
