# TaskFlow App - Cursor Agent Rules
# Generated by Cursor Agent Factory
# 5-Layer Architecture: Integrity → Purpose → Principles → Methodology → Technical

# ═══════════════════════════════════════════════════════════════════════════════
# LAYER 0: INTEGRITY & LOGIC (Axioms)
# ═══════════════════════════════════════════════════════════════════════════════

## Core Axioms (Immutable)

### A1: Verifiability
All agent outputs must be verifiable against source. For full-stack apps:
- All code changes traceable to requirements
- Type safety from database to UI
- Tests verify functionality

### A2: User Primacy
User intent takes precedence:
- Prioritize user experience in UI decisions
- Confirm before destructive operations
- Follow accessibility standards

### A3: Transparency
Agent reasoning must be explainable:
- Document component decisions
- Explain architectural choices
- Clear naming conventions

### A4: Non-Harm
No action may knowingly cause harm:
- Secure authentication implementation
- Protect user data
- Validate all inputs

### A5: Consistency
No rule may contradict these axioms:
- Consistent component patterns
- Uniform styling approach
- Standard file organization

# ═══════════════════════════════════════════════════════════════════════════════
# LAYER 1: PURPOSE
# ═══════════════════════════════════════════════════════════════════════════════

## Mission
To accelerate full-stack React development with type-safe patterns from database
to UI.

## Primary Stakeholders
Full-stack developers building modern React applications (team of 2-4).

## Success Criteria
Implement complete features from database to UI in under 2 hours with full
type safety.

## Purpose Alignment Check
Before implementing features:
- Is this end-to-end type safe?
- Does it follow Next.js conventions?
- Is the user experience smooth?

# ═══════════════════════════════════════════════════════════════════════════════
# LAYER 2: PRINCIPLES
# ═══════════════════════════════════════════════════════════════════════════════

## Quality Standards

### Code Quality
- TypeScript strict mode enabled
- ESLint with Next.js config
- Prettier for formatting
- No any types without justification

### Component Quality
- Server Components by default
- Client Components only when needed
- Proper loading and error states
- Accessible markup

### Performance
- Lighthouse score >= 90
- Core Web Vitals in green
- Optimized images and fonts
- Minimal client-side JavaScript

## Ethical Boundaries

### Data Protection
- Secure authentication with NextAuth.js
- Protect API routes
- Validate all user input
- No sensitive data in logs

# ═══════════════════════════════════════════════════════════════════════════════
# LAYER 3: METHODOLOGY
# ═══════════════════════════════════════════════════════════════════════════════

## Development Methodology: Kanban

### Flow Management
- Pull-based work assignment
- WIP limit: 3 items per developer
- Continuous deployment to preview

### Board Columns
- Backlog → Ready → In Progress → Review → Done

### Cycle Time Target
- Small features: < 1 day
- Medium features: < 3 days
- Large features: < 1 week (split if larger)

## Continuous Deployment
- PR previews with Vercel
- Automatic deployment on merge
- Feature flags for incomplete work

# ═══════════════════════════════════════════════════════════════════════════════
# LAYER 4: TECHNICAL
# ═══════════════════════════════════════════════════════════════════════════════

## Technology Stack

### Frontend
- Next.js 14+ (App Router)
- React 18+
- TypeScript 5+
- Tailwind CSS

### Backend
- Next.js API Routes / Server Actions
- Prisma ORM
- PostgreSQL

### Authentication
- NextAuth.js
- OAuth providers (Google, GitHub)

### Testing
- Vitest for unit tests
- Playwright for E2E
- Testing Library for components

## Project Structure
```
src/
├── app/                    # Next.js App Router
│   ├── (auth)/             # Auth pages (login, register)
│   ├── (dashboard)/        # Protected pages
│   ├── api/                # API routes
│   ├── layout.tsx          # Root layout
│   └── page.tsx            # Home page
├── components/
│   ├── ui/                 # Base UI components
│   └── [feature]/          # Feature components
├── lib/                    # Utilities
│   ├── prisma.ts           # Prisma client
│   └── auth.ts             # Auth utilities
└── server/
    ├── actions/            # Server Actions
    └── services/           # Business logic
```

## Conventions

### File Naming
- Components: PascalCase (TaskCard.tsx)
- Utilities: camelCase (formatDate.ts)
- Routes: lowercase with hyphens

### Component Pattern
```typescript
// Server Component (default)
export default async function Page() {
  const data = await fetchData()
  return <Component data={data} />
}

// Client Component (when needed)
"use client"
export function InteractiveComponent() {
  const [state, setState] = useState()
  return <div onClick={() => setState(...)}>...</div>
}
```

# ═══════════════════════════════════════════════════════════════════════════════
# AGENT REGISTRY
# ═══════════════════════════════════════════════════════════════════════════════

## Available Agents

### code-reviewer
- Purpose: Review for Next.js patterns and TypeScript quality
- Focus: Server vs Client components, type safety

### test-generator
- Purpose: Generate Vitest and Playwright tests
- Focus: Component tests, E2E flows

### documentation-agent
- Purpose: Generate and maintain documentation
- Focus: API docs, component storybook

## Available Skills

### feature-workflow
- Purpose: End-to-end feature implementation
- Flow: Schema → Actions → Components → Tests

### tdd
- Purpose: Test-driven development
- Flow: Test → Implement → Refactor

# ═══════════════════════════════════════════════════════════════════════════════
# KNOWLEDGE FILES
# ═══════════════════════════════════════════════════════════════════════════════

## Reference Data
- knowledge/nextjs-patterns.json - Next.js 14 App Router patterns
- knowledge/prisma-patterns.json - Prisma schema and query patterns
- knowledge/react-patterns.json - React component patterns

# ═══════════════════════════════════════════════════════════════════════════════
# BEHAVIOR RULES
# ═══════════════════════════════════════════════════════════════════════════════

## Component Rules
1. Use Server Components by default
2. Add "use client" only for interactivity
3. Colocate loading.tsx and error.tsx
4. Use Suspense for streaming

## Data Rules
1. Fetch data in Server Components
2. Use Server Actions for mutations
3. Revalidate paths after mutations
4. Handle optimistic updates in client

## Styling Rules
1. Use Tailwind CSS classes
2. Extract repeated patterns to components
3. Use CSS variables for theming
4. Mobile-first responsive design
