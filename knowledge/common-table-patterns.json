{
  "metadata": {
    "name": "SAP Common Table Patterns",
    "description": "Common SAP table structures, naming patterns, and access methods",
    "version": "1.0.0",
    "lastUpdated": "2026-01-30"
  },
  "tableCategories": {
    "transparent": {
      "description": "Direct 1:1 mapping to database table",
      "annotation": "@AbapCatalog.tableCategory: #TRANSPARENT",
      "useCase": "Application data, configuration"
    },
    "cluster": {
      "description": "Multiple tables stored in single database table",
      "useCase": "Rarely used in new development"
    },
    "pool": {
      "description": "Small tables grouped in pool",
      "useCase": "Legacy configuration tables"
    }
  },
  "deliveryClass": {
    "A": {"description": "Application table (master and transaction data)", "transportable": true},
    "C": {"description": "Customizing table, maintenance by customer", "transportable": true},
    "L": {"description": "Temporary data, deleted at installation", "transportable": false},
    "G": {"description": "Customizing, protected against overwrite", "transportable": true},
    "E": {"description": "Control table, SAP and customer have own key ranges", "transportable": true},
    "S": {"description": "System table, maintenance only by SAP", "transportable": true},
    "W": {"description": "System table, contents transportable via own TR objects", "transportable": true}
  },
  "commonPatterns": {
    "masterData": {
      "description": "Business partner, material, customer data",
      "characteristics": ["Long-lived", "Central reference", "Versioned"],
      "examples": ["BUT000 (Business Partner)", "MARA (Material Master)", "KNA1 (Customer Master)"],
      "keyPattern": "Client + Business key"
    },
    "transactionData": {
      "description": "Orders, invoices, deliveries",
      "characteristics": ["Time-bound", "Workflow states", "Document flow"],
      "examples": ["VBAK (Sales Order Header)", "EKKO (Purchase Order Header)", "LIKP (Delivery Header)"],
      "keyPattern": "Client + Document number"
    },
    "configurationData": {
      "description": "Settings, mappings, rules",
      "characteristics": ["Transported", "Rarely changed", "Key-value or rule-based"],
      "keyPattern": "Client + Configuration key"
    },
    "textTables": {
      "description": "Language-dependent texts",
      "pattern": "Base table + _T suffix",
      "examples": ["MAKT (Material texts)", "T001W (Plant texts)"],
      "keyPattern": "Base key + SPRAS (Language)"
    },
    "headerItemPattern": {
      "description": "Document header with line items",
      "header": "Document key fields, totals, status",
      "item": "Header key + item number, quantities, amounts",
      "examples": {
        "salesOrder": {"header": "VBAK", "item": "VBAP"},
        "purchaseOrder": {"header": "EKKO", "item": "EKPO"},
        "delivery": {"header": "LIKP", "item": "LIPS"}
      }
    }
  },
  "auditFields": {
    "description": "Standard fields for tracking changes",
    "fields": [
      {"name": "ERDAT", "description": "Created date", "type": "DATS"},
      {"name": "ERNAM", "description": "Created by user", "type": "UNAME"},
      {"name": "ERZET", "description": "Created time", "type": "TIMS"},
      {"name": "AEDAT", "description": "Changed date", "type": "DATS"},
      {"name": "AENAM", "description": "Changed by user", "type": "UNAME"},
      {"name": "AEZET", "description": "Changed time", "type": "TIMS"}
    ],
    "cdsAnnotations": [
      "@Semantics.user.createdBy: true",
      "@Semantics.systemDateTime.createdAt: true",
      "@Semantics.user.lastChangedBy: true",
      "@Semantics.systemDateTime.lastChangedAt: true"
    ]
  },
  "clientHandling": {
    "description": "MANDT field for multi-tenancy",
    "annotation": "@AbapCatalog.enhancementCategory: #NOT_CLASSIFIED",
    "options": {
      "clientDependent": "Table contains MANDT as first key field",
      "clientIndependent": "Cross-client data (rare)"
    }
  },
  "keyPatterns": {
    "naturalKey": {
      "description": "Business-meaningful key",
      "examples": ["Material number", "Customer number", "Document number"],
      "pros": ["Readable", "Business context"],
      "cons": ["May need to change", "Complex for compositions"]
    },
    "surrogateKey": {
      "description": "System-generated key (UUID or number range)",
      "examples": ["UUID", "Number range ID"],
      "pros": ["Stable", "No business logic in key"],
      "cons": ["Not human-readable"]
    },
    "compositeKey": {
      "description": "Multiple fields form the key",
      "examples": ["Header + Item number", "Date + Sequence"],
      "useCase": "Line items, time-based data"
    }
  },
  "indexPatterns": {
    "primaryIndex": {
      "description": "Based on primary key, created automatically"
    },
    "secondaryIndex": {
      "description": "Additional indexes for query performance",
      "naming": "Z{TABLE}~{INDEX_NAME}",
      "considerations": ["Query patterns", "Update frequency", "Index maintenance"]
    }
  },
  "accessPatterns": {
    "singleRecord": {
      "pattern": "SELECT SINGLE ... WHERE key = @value",
      "useCase": "Lookup by key"
    },
    "rangeSelect": {
      "pattern": "SELECT ... WHERE field IN @range",
      "useCase": "Filtered queries"
    },
    "joinPattern": {
      "pattern": "SELECT ... FROM table1 INNER JOIN table2 ON ...",
      "useCase": "Related data"
    },
    "cdsView": {
      "description": "Prefer CDS views over direct table access",
      "benefits": ["Abstraction", "Reusability", "Annotations"]
    }
  },
  "bestPractices": [
    "Use CDS views instead of direct table access",
    "Include audit fields in all custom tables",
    "Follow SAP naming conventions (Z/Y prefix)",
    "Define appropriate delivery class",
    "Create secondary indexes for frequent queries",
    "Use number ranges for document numbers",
    "Implement change documents for audit trails",
    "Consider archiving strategy for transactional data"
  ]
}
