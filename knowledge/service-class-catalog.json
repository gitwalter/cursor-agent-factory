{
  "metadata": {
    "name": "Service Class Catalog",
    "description": "Patterns and catalog for ABAP service classes following Clean ABAP principles",
    "version": "1.0.0",
    "lastUpdated": "2026-01-30"
  },
  "serviceLayerPatterns": {
    "overview": {
      "description": "Service classes encapsulate business logic and coordinate operations",
      "principles": [
        "Single Responsibility - one service per domain",
        "Dependency Injection - inject dependencies via constructor",
        "Interface Segregation - define interfaces for testability",
        "Separation of Concerns - business logic separate from data access"
      ]
    },
    "layers": {
      "presentation": {
        "purpose": "Handle UI interaction, validation, formatting",
        "examples": ["Report classes", "Fiori handlers", "API controllers"]
      },
      "application": {
        "purpose": "Orchestrate use cases, transaction management",
        "examples": ["ZCL_TRAVEL_APPLICATION_SERVICE", "ZCL_BOOKING_USE_CASE"]
      },
      "domain": {
        "purpose": "Core business logic, domain rules",
        "examples": ["ZCL_TRAVEL_DOMAIN_SERVICE", "ZCL_PRICING_ENGINE"]
      },
      "infrastructure": {
        "purpose": "Data access, external integrations",
        "examples": ["ZCL_TRAVEL_REPOSITORY", "ZCL_SAP_CONNECTOR"]
      }
    }
  },
  "servicePatterns": {
    "crudService": {
      "description": "Basic CRUD operations for an entity",
      "interface": "ZIF_TRAVEL_SERVICE",
      "methods": [
        {"name": "get_by_id", "parameters": "travel_id", "returns": "travel_data"},
        {"name": "get_all", "parameters": "filter_criteria", "returns": "travel_list"},
        {"name": "create", "parameters": "travel_data", "returns": "travel_id"},
        {"name": "update", "parameters": "travel_id, travel_data", "returns": "void"},
        {"name": "delete", "parameters": "travel_id", "returns": "void"}
      ],
      "example": "CLASS zcl_travel_service DEFINITION PUBLIC FINAL CREATE PUBLIC.\n  PUBLIC SECTION.\n    INTERFACES zif_travel_service.\n    METHODS constructor IMPORTING repository TYPE REF TO zif_travel_repository.\n  PRIVATE SECTION.\n    DATA repository TYPE REF TO zif_travel_repository.\nENDCLASS."
    },
    "domainService": {
      "description": "Complex business logic that spans multiple entities",
      "methods": [
        {"name": "calculate_total_price", "parameters": "travel_id", "returns": "amount"},
        {"name": "apply_discount", "parameters": "travel_id, discount_percent", "returns": "void"},
        {"name": "validate_booking", "parameters": "booking_data", "returns": "validation_result"}
      ]
    },
    "orchestrationService": {
      "description": "Coordinate multiple services for a use case",
      "pattern": "Saga pattern for distributed transactions",
      "methods": [
        {"name": "book_travel", "description": "Orchestrate travel booking across services"},
        {"name": "cancel_travel", "description": "Coordinate cancellation with refund"}
      ]
    },
    "validationService": {
      "description": "Centralized validation logic",
      "methods": [
        {"name": "validate", "parameters": "entity_data", "returns": "validation_result"},
        {"name": "is_valid", "parameters": "entity_data", "returns": "boolean"}
      ]
    },
    "transformationService": {
      "description": "Data transformation and mapping",
      "methods": [
        {"name": "to_dto", "description": "Convert entity to DTO"},
        {"name": "from_dto", "description": "Convert DTO to entity"},
        {"name": "map_external", "description": "Map external format to internal"}
      ]
    }
  },
  "repositoryPatterns": {
    "description": "Data access abstraction",
    "interface": "ZIF_TRAVEL_REPOSITORY",
    "methods": [
      {"name": "find_by_id", "parameters": "id", "returns": "entity or initial"},
      {"name": "find_all", "parameters": "criteria", "returns": "entity_list"},
      {"name": "save", "parameters": "entity", "returns": "void"},
      {"name": "delete", "parameters": "id", "returns": "void"},
      {"name": "exists", "parameters": "id", "returns": "boolean"}
    ],
    "implementations": {
      "database": "Direct database access",
      "cds": "CDS view access",
      "bapi": "BAPI wrapper",
      "mock": "In-memory for testing"
    }
  },
  "factoryPatterns": {
    "simpleFactory": {
      "description": "Create objects based on type",
      "example": "METHODS create_travel IMPORTING type TYPE string RETURNING VALUE(result) TYPE REF TO zif_travel."
    },
    "abstractFactory": {
      "description": "Create families of related objects",
      "useCase": "Different implementations per system landscape"
    },
    "dependencyInjection": {
      "description": "Inject dependencies via constructor",
      "pattern": "METHODS constructor IMPORTING\n  repository TYPE REF TO zif_repository\n  validator TYPE REF TO zif_validator."
    }
  },
  "exceptionHandling": {
    "pattern": "Define exception class hierarchy per domain",
    "base": "ZCX_TRAVEL_ERROR (inherits from CX_STATIC_CHECK)",
    "specific": [
      "ZCX_TRAVEL_NOT_FOUND",
      "ZCX_TRAVEL_VALIDATION_FAILED",
      "ZCX_TRAVEL_AUTHORIZATION_FAILED"
    ],
    "usage": "RAISING zcx_travel_error in method signature"
  },
  "testability": {
    "interface": "Define interface for every service",
    "mockImplementation": "Create mock implementation for tests",
    "testDouble": "Use test double framework for complex mocking",
    "example": "CLASS zcl_travel_repository_mock DEFINITION FOR TESTING.\n  PUBLIC SECTION.\n    INTERFACES zif_travel_repository.\nENDCLASS."
  },
  "catalogExample": {
    "travelDomain": {
      "services": [
        {"name": "ZCL_TRAVEL_SERVICE", "interface": "ZIF_TRAVEL_SERVICE", "purpose": "Travel CRUD operations"},
        {"name": "ZCL_TRAVEL_PRICING_SERVICE", "interface": "ZIF_PRICING_SERVICE", "purpose": "Price calculation"},
        {"name": "ZCL_TRAVEL_VALIDATION_SERVICE", "interface": "ZIF_VALIDATION_SERVICE", "purpose": "Business validation"}
      ],
      "repositories": [
        {"name": "ZCL_TRAVEL_REPOSITORY", "interface": "ZIF_TRAVEL_REPOSITORY", "purpose": "Travel data access"},
        {"name": "ZCL_BOOKING_REPOSITORY", "interface": "ZIF_BOOKING_REPOSITORY", "purpose": "Booking data access"}
      ],
      "factories": [
        {"name": "ZCL_TRAVEL_FACTORY", "purpose": "Create travel service with dependencies"}
      ],
      "exceptions": [
        {"name": "ZCX_TRAVEL_ERROR", "purpose": "Base exception for travel domain"},
        {"name": "ZCX_TRAVEL_NOT_FOUND", "purpose": "Travel entity not found"},
        {"name": "ZCX_TRAVEL_VALIDATION", "purpose": "Validation failure"}
      ]
    }
  },
  "bestPractices": [
    "One interface per service for testability",
    "Use dependency injection via constructor",
    "Keep services focused on single responsibility",
    "Separate business logic from data access",
    "Use value objects for complex parameters",
    "Define clear exception hierarchy",
    "Write unit tests for all services",
    "Document public interfaces thoroughly"
  ]
}
