{
  "metadata": {
    "blueprintId": "sap-cpi-pi",
    "blueprintName": "SAP CPI/PI Integration Blueprint",
    "description": "SAP Cloud Platform Integration and Process Integration development with Groovy scripts, Java adapters, and iFlow patterns",
    "version": "1.0.0",
    "author": "Cursor Agent Factory",
    "tags": ["sap", "cpi", "pi", "integration", "groovy", "java", "iflow", "b2b", "edi"],
    "purpose": "Enable SAP integration developers to build robust iFlows with proper patterns, error handling, and testing"
  },
  "stack": {
    "primaryLanguage": "groovy",
    "secondaryLanguage": "java",
    "frameworks": [
      {"name": "SAP CPI Groovy SDK", "version": "1.x", "purpose": "Cloud Platform Integration scripting"},
      {"name": "SAP PI Adapter Framework", "version": "7.5+", "purpose": "On-premise adapter development"},
      {"name": "Apache Camel", "version": "underlying", "purpose": "Integration framework (CPI foundation)"}
    ],
    "platforms": [
      {"name": "SAP Integration Suite", "type": "cloud", "purpose": "Cloud-based integration"},
      {"name": "SAP CPI", "type": "cloud", "purpose": "Cloud Platform Integration"},
      {"name": "SAP PI/PO", "type": "on-premise", "purpose": "Process Integration/Orchestration"}
    ],
    "protocols": [
      {"name": "REST/OData", "purpose": "API-based integrations"},
      {"name": "SOAP", "purpose": "Web services"},
      {"name": "IDoc", "purpose": "SAP native document exchange"},
      {"name": "SFTP/AS2", "purpose": "B2B file transfer"},
      {"name": "EDIFACT/X12", "purpose": "EDI standards"},
      {"name": "AMQP/Kafka", "purpose": "Event-driven messaging"}
    ],
    "tools": [
      {"name": "Eclipse", "purpose": "PI development (NWDS)"},
      {"name": "IntelliJ IDEA", "purpose": "Groovy/Java development"},
      {"name": "SAP CPI Web IDE", "purpose": "Cloud iFlow development"},
      {"name": "Postman", "purpose": "API testing"},
      {"name": "SoapUI", "purpose": "SOAP service testing"},
      {"name": "Spock Framework", "purpose": "Groovy unit testing"}
    ],
    "styleGuides": [
      {"name": "groovy-style", "description": "Groovy Style Guide", "reference": "https://groovy-lang.org/style-guide.html"},
      {"name": "sap-cpi-guidelines", "description": "SAP CPI Best Practices", "reference": "https://help.sap.com/docs/cloud-integration"}
    ]
  },
  "agents": [
    {"patternId": "code-reviewer", "required": true, "customizations": {"skills": ["groovy-scripting", "grounding"], "focus": "CPI patterns, error handling, performance"}},
    {"patternId": "test-generator", "required": true, "customizations": {"skills": ["tdd"], "focus": "Groovy script tests, mock message testing"}},
    {"patternId": "documentation-agent", "required": false, "customizations": {"focus": "iFlow documentation, mapping specs"}}
  ],
  "skills": [
    {"patternId": "iflow-development", "required": true, "description": "Complete iFlow creation workflow"},
    {"patternId": "groovy-scripting", "required": true, "description": "Groovy script development with CPI patterns"},
    {"patternId": "error-handling", "required": true, "description": "Exception handling and alerting"},
    {"patternId": "b2b-integration", "required": false, "description": "B2B/EDI specific workflows"},
    {"patternId": "grounding", "required": true, "description": "Verify against SAP documentation"},
    {"patternId": "tdd", "required": true, "description": "Test-driven script development"},
    {"patternId": "bugfix-workflow", "required": true},
    {"patternId": "feature-workflow", "required": true}
  ],
  "knowledge": [
    {"filename": "groovy-patterns.json", "description": "Groovy scripting best practices for CPI"},
    {"filename": "iflow-patterns.json", "description": "Integration flow design patterns"},
    {"filename": "cpi-error-handling.json", "description": "Exception handling and alerting patterns"},
    {"filename": "mapping-patterns.json", "description": "Message mapping techniques"},
    {"filename": "b2b-patterns.json", "description": "EDI, IDoc, partner management patterns"},
    {"filename": "security-patterns.json", "description": "OAuth, certificates, credential management"}
  ],
  "templates": {
    "codeTemplates": [
      {"category": "groovy-script", "directory": "templates/integration/groovy/"},
      {"category": "message-mapping", "directory": "templates/integration/mapping/"},
      {"category": "java-adapter", "directory": "templates/integration/java/"},
      {"category": "test-script", "directory": "templates/integration/test/"}
    ],
    "documentTemplates": [
      {"name": "iflow_spec.md", "directory": "templates/docs/"},
      {"name": "mapping_spec.md", "directory": "templates/docs/"},
      {"name": "interface_spec.md", "directory": "templates/docs/"}
    ]
  },
  "workflows": [
    {"patternId": "iflow-development", "customizations": {}},
    {"patternId": "jira-bugfix", "customizations": {}},
    {"patternId": "confluence-feature", "customizations": {}}
  ],
  "mcpServers": [
    {"name": "sap-docs", "purpose": "SAP Help Portal and CPI documentation", "required": true},
    {"name": "atlassian", "url": "https://mcp.atlassian.com/v1/sse", "purpose": "Jira/Confluence", "required": false}
  ],
  "projectStructure": {
    "directories": [
      {"path": ".cursor/agents/", "purpose": "AI agent definitions"},
      {"path": ".cursor/skills/", "purpose": "Reusable skills"},
      {"path": "knowledge/", "purpose": "Reference patterns"},
      {"path": "src/main/groovy/scripts/", "purpose": "Groovy scripts"},
      {"path": "src/main/groovy/mappings/", "purpose": "Message mappings"},
      {"path": "src/main/java/adapters/", "purpose": "Custom Java adapters"},
      {"path": "src/main/resources/", "purpose": "Configuration files"},
      {"path": "src/test/groovy/", "purpose": "Groovy tests (Spock)"},
      {"path": "iflows/", "purpose": "iFlow definitions"},
      {"path": "docs/", "purpose": "Interface documentation"},
      {"path": "workflows/", "purpose": "Methodology configuration"}
    ],
    "files": [
      {"path": ".cursorrules", "purpose": "Agent behavior rules"},
      {"path": "PURPOSE.md", "purpose": "Purpose document"},
      {"path": "README.md", "purpose": "Project documentation"},
      {"path": "build.gradle", "purpose": "Gradle build for testing"}
    ]
  },
  "cursorrules": {
    "variables": [
      {"name": "CPI_TENANT", "description": "CPI tenant URL", "default": ""},
      {"name": "STYLE_GUIDE", "description": "Coding style", "default": "groovy-style"},
      {"name": "LOG_LEVEL", "description": "Default log level", "default": "INFO"}
    ],
    "rules": [
      {"name": "Null Safety", "description": "Use Groovy safe navigation (?.) for null handling"},
      {"name": "Logging", "description": "Use messageLog for CPI logging, never System.out"},
      {"name": "Error Handling", "description": "Always use try-catch with proper exception routing"},
      {"name": "Properties", "description": "Use message properties/headers, not hardcoded values"},
      {"name": "Closures", "description": "Use closures for collection operations"},
      {"name": "Testing", "description": "Write Spock tests for all scripts"},
      {"name": "Security", "description": "Never hardcode credentials, use Secure Parameters"}
    ]
  },
  "groovyPatterns": {
    "messageAccess": {
      "description": "Accessing message body and properties",
      "example": "def body = message.getBody(String); def prop = message.getProperty('propName')"
    },
    "xmlParsing": {
      "description": "XML parsing with XmlSlurper",
      "example": "def xml = new XmlSlurper().parseText(body)"
    },
    "jsonParsing": {
      "description": "JSON parsing with JsonSlurper",
      "example": "def json = new JsonSlurper().parseText(body)"
    },
    "logging": {
      "description": "Proper CPI logging",
      "example": "def messageLog = messageLogFactory.getMessageLog(message); messageLog.addAttachmentAsString('Debug', body, 'text/plain')"
    },
    "errorHandling": {
      "description": "Exception handling pattern",
      "example": "try { /* logic */ } catch (Exception e) { message.setProperty('ErrorMessage', e.message); throw e }"
    }
  },
  "layerDefaults": {
    "layer0": {
      "coreAxioms": ["A1", "A2", "A3", "A4", "A5"],
      "optionalAxioms": ["A6", "A7"],
      "note": "A6 (Minimalism) keeps scripts focused. A7 (Reversibility) for transport management."
    },
    "layer1": {
      "purposeTemplate": "To build reliable SAP integrations with proper error handling, monitoring, and maintainability",
      "stakeholders": "Integration developers, SAP Basis team, business process owners"
    },
    "layer3": {
      "methodology": "kanban",
      "note": "Kanban suits interrupt-driven integration support work. Use Scrum for larger projects."
    }
  }
}
