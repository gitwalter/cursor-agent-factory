{
  "metadata": {
    "blueprintId": "sap-rap",
    "blueprintName": "SAP RAP Blueprint",
    "description": "RESTful ABAP Programming (RAP) development with CDS, Behavior Definitions, Fiori Elements, and ABAP Cloud",
    "version": "1.0.0",
    "author": "Cursor Agent Factory",
    "tags": ["sap", "rap", "cds", "fiori-elements", "abap-cloud", "btp", "odata", "draft"],
    "purpose": "Enable RAP developers to build modern business objects with proper behavior definitions, validations, determinations, actions, and Fiori UIs"
  },
  "stack": {
    "primaryLanguage": "abap",
    "secondaryLanguages": ["cds"],
    "frameworks": [
      {"name": "RAP", "version": "2.x", "purpose": "RESTful ABAP Programming framework"},
      {"name": "CDS", "version": "latest", "purpose": "Core Data Services for data modeling"},
      {"name": "Fiori Elements", "version": "1.x", "purpose": "Annotation-driven UI generation"},
      {"name": "ABAP Cloud", "version": "2302+", "purpose": "Cloud-compatible ABAP development"}
    ],
    "tools": [
      {"name": "Eclipse ADT", "version": "latest", "purpose": "ABAP Development Tools IDE"},
      {"name": "ABAP Unit", "version": "latest", "purpose": "Unit testing framework"},
      {"name": "abaplint", "version": "latest", "purpose": "ABAP linting and static analysis"},
      {"name": "SAP Business Application Studio", "purpose": "Cloud-based development"}
    ],
    "styleGuides": [
      {"name": "clean-abap", "description": "SAP Clean ABAP", "reference": "https://github.com/SAP/styleguides/blob/main/clean-abap/CleanABAP.md", "enforcement": "required"}
    ]
  },
  "agents": [
    {"patternId": "code-reviewer", "required": true, "customizations": {"name": "rap-code-reviewer", "skills": ["rap-patterns", "sap-grounding"], "focus": "RAP behavior definitions, CDS views, Fiori annotations"}},
    {"patternId": "test-generator", "required": true, "customizations": {"name": "rap-test-generator", "skills": ["tdd-rap"], "focus": "ABAP Unit tests for RAP behavior implementations"}},
    {"patternId": "documentation-agent", "required": false, "customizations": {"name": "fiori-specialist", "focus": "Fiori Elements annotations and UI patterns"}},
    {"patternId": "explorer", "required": true, "customizations": {"name": "rap-explorer"}}
  ],
  "skills": [
    {"patternId": "rap-behavior-design", "required": true, "description": "Behavior definition patterns and best practices"},
    {"patternId": "rap-draft-handling", "required": true, "description": "Draft-enabled business object patterns"},
    {"patternId": "rap-fiori-annotations", "required": true, "description": "Fiori Elements annotation patterns"},
    {"patternId": "rap-testing", "required": true, "description": "ABAP Unit testing for RAP"},
    {"patternId": "grounding", "required": true, "customizations": {"name": "sap-grounding"}},
    {"patternId": "tdd", "required": true, "customizations": {"name": "tdd-rap"}},
    {"patternId": "bugfix-workflow", "required": true},
    {"patternId": "feature-workflow", "required": true}
  ],
  "knowledge": [
    {"filename": "sap-cap-patterns.json", "description": "SAP CAP, CDS, RAP, and ABAP Cloud patterns", "required": true},
    {"filename": "naming-conventions.json", "description": "ABAP naming conventions (Clean ABAP)"},
    {"filename": "tadir-object-types.json", "description": "ABAP repository object types"},
    {"filename": "service-class-catalog.json", "description": "Service class patterns"},
    {"filename": "sap-reference-repos.json", "description": "SAP RAP sample repositories"}
  ],
  "templates": {
    "behaviorDefinitions": [
      {"category": "behavior-basic", "directory": "templates/abap/rap/behavior/", "description": "Basic CRUD behavior definition"},
      {"category": "behavior-draft", "directory": "templates/abap/rap/behavior/", "description": "Draft-enabled behavior definition"},
      {"category": "behavior-validation", "directory": "templates/abap/rap/behavior/", "description": "Behavior with validations"},
      {"category": "behavior-determination", "directory": "templates/abap/rap/behavior/", "description": "Behavior with determinations"},
      {"category": "behavior-action", "directory": "templates/abap/rap/behavior/", "description": "Behavior with custom actions"},
      {"category": "behavior-numbering", "directory": "templates/abap/rap/behavior/", "description": "Behavior with automatic numbering"},
      {"category": "behavior-authorization", "directory": "templates/abap/rap/behavior/", "description": "Behavior with authorization"},
      {"category": "behavior-child", "directory": "templates/abap/rap/behavior/", "description": "Child entity behavior definition"}
    ],
    "behaviorImplementations": [
      {"category": "implementation-basic", "directory": "templates/abap/rap/implementation/", "description": "Basic behavior implementation"},
      {"category": "implementation-validation", "directory": "templates/abap/rap/implementation/", "description": "Validation implementation"},
      {"category": "implementation-determination", "directory": "templates/abap/rap/implementation/", "description": "Determination implementation"},
      {"category": "implementation-action", "directory": "templates/abap/rap/implementation/", "description": "Action implementation"},
      {"category": "implementation-draft", "directory": "templates/abap/rap/implementation/", "description": "Draft handling implementation"},
      {"category": "implementation-authorization", "directory": "templates/abap/rap/implementation/", "description": "Authorization implementation"},
      {"category": "implementation-numbering", "directory": "templates/abap/rap/implementation/", "description": "Numbering implementation"}
    ],
    "cdsViews": [
      {"category": "cds-entity", "directory": "templates/abap/rap/cds/", "description": "Base CDS entity definition"},
      {"category": "cds-interface-view", "directory": "templates/abap/rap/cds/", "description": "Interface CDS view"},
      {"category": "cds-projection", "directory": "templates/abap/rap/cds/", "description": "Projection CDS view with UI annotations"},
      {"category": "cds-aspect", "directory": "templates/abap/rap/cds/", "description": "Reusable CDS aspect"},
      {"category": "cds-draft-table", "directory": "templates/abap/rap/cds/", "description": "Draft table definition"},
      {"category": "service-definition", "directory": "templates/abap/rap/cds/", "description": "Service definition"}
    ],
    "fioriAnnotations": [
      {"category": "fiori-list-report", "directory": "templates/abap/rap/fiori/", "description": "List report annotations"},
      {"category": "fiori-object-page", "directory": "templates/abap/rap/fiori/", "description": "Object page annotations"}
    ],
    "testTemplates": [
      {"category": "test-behavior", "directory": "templates/abap/rap/test/", "description": "Behavior implementation test"},
      {"category": "test-validation", "directory": "templates/abap/rap/test/", "description": "Validation test"}
    ]
  },
  "mcpServers": [
    {"name": "sap-documentation", "url": "https://mcp-sap-docs.marianzeis.de/mcp", "purpose": "SAP Help Portal, RAP, CDS, Fiori Elements documentation", "required": true},
    {"name": "atlassian", "url": "https://mcp.atlassian.com/v1/sse", "purpose": "Jira/Confluence integration for requirements", "required": false},
    {"name": "deepwiki", "url": "https://mcp.deepwiki.com/mcp", "purpose": "SAP RAP sample repositories and examples", "required": true}
  ],
  "projectStructure": {
    "directories": [
      {"path": ".cursor/agents/", "purpose": "AI agent definitions"},
      {"path": ".cursor/skills/", "purpose": "Reusable skills"},
      {"path": "knowledge/", "purpose": "RAP reference patterns"},
      {"path": "src/", "purpose": "ABAP source files"},
      {"path": "src/behavior/", "purpose": "Behavior definitions"},
      {"path": "src/cds/", "purpose": "CDS views and entities"},
      {"path": "src/implementation/", "purpose": "Behavior implementations"},
      {"path": "test/", "purpose": "ABAP Unit tests"},
      {"path": "docs/", "purpose": "Documentation"},
      {"path": "diagrams/", "purpose": "Architecture diagrams"}
    ],
    "files": [
      {"path": ".cursorrules", "purpose": "Agent behavior rules"},
      {"path": "PURPOSE.md", "purpose": "Purpose document"},
      {"path": "README.md", "purpose": "Project documentation"}
    ]
  },
  "enforcement": [
    {"patternId": "rap-pattern-compliance", "required": true, "description": "Ensure RAP patterns are followed correctly"},
    {"patternId": "cds-best-practices", "required": true, "description": "Enforce CDS modeling best practices"},
    {"patternId": "fiori-annotation-compliance", "required": true, "description": "Validate Fiori Elements annotations"},
    {"patternId": "clean-abap-enforcement", "required": true, "description": "Enforce Clean ABAP guidelines"},
    {"patternId": "abap-unit-coverage", "required": true, "description": "Require ABAP Unit test coverage"}
  ],
  "testing": {
    "frameworks": [
      {"name": "ABAP Unit", "purpose": "Unit testing for behavior implementations", "required": true},
      {"name": "Test Double Framework", "purpose": "Mocking dependencies", "required": false}
    ],
    "patterns": [
      {"name": "Given-When-Then", "description": "Structure test methods using Spock-like blocks"},
      {"name": "EML Testing", "description": "Use Entity Manipulation Language for RAP tests"},
      {"name": "Test Isolation", "description": "Each test should be independent"},
      {"name": "Mock Entities", "description": "Mock RAP entities for unit testing"},
      {"name": "Validation Testing", "description": "Test all validation scenarios"},
      {"name": "Action Testing", "description": "Test custom action implementations"}
    ]
  },
  "cursorrules": {
    "variables": [
      {"name": "RAP_SCENARIO", "description": "RAP development scenario", "default": "managed"},
      {"name": "DRAFT_ENABLED", "description": "Enable draft handling", "default": "true"},
      {"name": "FIORI_ANNOTATIONS", "description": "Generate Fiori annotations", "default": "true"},
      {"name": "ABAP_CLOUD_MODE", "description": "ABAP Cloud compatibility mode", "default": "false"}
    ],
    "rules": [
      {"name": "CDS-First Development", "description": "Always start with CDS entity and view definitions. Separate base views from projection views."},
      {"name": "Behavior Definition First", "description": "Define behavior before implementation. Use managed scenario unless unmanaged is required."},
      {"name": "Draft Handling", "description": "Use draft for complex editing scenarios. Include Edit, Activate, Discard, Resume actions."},
      {"name": "Validation Pattern", "description": "Implement validations using on save triggers. Report errors using %msg structure."},
      {"name": "Determination Pattern", "description": "Use on modify for immediate calculations, on save for final computations."},
      {"name": "Action Pattern", "description": "Define actions with proper parameters and results. Use features:instance for conditional actions."},
      {"name": "Authorization", "description": "Implement both global and instance authorization. Use AUTHORITY-CHECK in get_authorizations."},
      {"name": "Numbering", "description": "Use early numbering with FOR NUMBERING. Integrate with number ranges."},
      {"name": "Fiori Annotations", "description": "Add @UI.lineItem for list reports, @UI.identification for object pages, @UI.facet for page structure."},
      {"name": "EML Usage", "description": "Use READ ENTITIES and MODIFY ENTITIES for data access. Always use LOCAL MODE in behavior implementations."},
      {"name": "Testing", "description": "Write ABAP Unit tests for all validations, determinations, and actions. Use Given-When-Then structure."},
      {"name": "MCP Integration", "description": "Use SAP documentation MCP for RAP, CDS, and Fiori Elements questions. Verify patterns against official documentation."}
    ]
  },
  "rapPatterns": {
    "managedScenario": {
      "description": "Framework handles CRUD operations",
      "useCase": "Standard business objects with full framework support",
      "features": ["Automatic CRUD", "Draft handling", "Lock management", "ETag handling"]
    },
    "unmanagedScenario": {
      "description": "Custom CRUD implementation",
      "useCase": "Legacy data, complex business logic, external systems",
      "features": ["Full control over data operations", "Custom persistence logic"]
    },
    "projectionScenario": {
      "description": "Read-only or restricted projections",
      "useCase": "API exposure, reporting, analytics",
      "features": ["Subset of fields", "Calculated fields", "Aggregations"]
    }
  },
  "layerDefaults": {
    "layer0": {
      "coreAxioms": ["A1", "A2", "A3", "A4", "A5"],
      "optionalAxioms": ["A6", "A7"],
      "note": "A6 (Minimalism) keeps behavior focused. A7 (Reversibility) for transport management."
    },
    "layer1": {
      "purposeTemplate": "To build modern SAP business applications using RAP with proper separation of concerns, testability, and Fiori integration",
      "stakeholders": "ABAP developers, Fiori developers, business analysts, SAP Basis team"
    },
    "layer3": {
      "methodology": "agile-scrum",
      "note": "Scrum suits iterative RAP development with sprints for entities, behaviors, and UI."
    }
  }
}
